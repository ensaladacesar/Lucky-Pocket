{"version":3,"sources":["webpack:///./src/app/login/login.module.ts","webpack:///./src/app/login/login.page.html","webpack:///./src/app/login/login.page.scss","webpack:///./src/app/login/login.page.ts","webpack:///./src/app/services/user.service.ts"],"names":[],"mappings":"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","file":"login-login-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","module.exports = \"<ion-content>\\n  <ion-row justify-content-center align-items-center class=\\\"redBgFull text-center\\\">\\n    <ion-button expand=\\\"block\\\" (click)=\\\"doFbLogin()\\\">Login con facebook</ion-button>\\n  </ion-row>\\n  \\n</ion-content>\\n\"","module.exports = \".redBgFull {\\n  background-color: #E83F4B;\\n  background-position: center center;\\n  background-size: cover;\\n  height: 100% !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9jZXNhcmhlcm5hbmRlenJvY2hhL1NpdGVzL0x1Y2t5LVBvY2tldC9zcmMvYXBwL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLHlCQUF5QjtFQUN6QixrQ0FBa0M7RUFDbEMsc0JBQXNCO0VBQ3RCLHVCQUF1QixFQUFBIiwiZmlsZSI6InNyYy9hcHAvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnJlZEJnRnVsbHsgXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0U4M0Y0QjtcbiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXIgY2VudGVyO1xuICAgIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XG4gICAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7IFxufVxuIl19 */\"","import { Component, OnInit } from '@angular/core';\nimport { Facebook } from '@ionic-native/facebook/ngx';\nimport { Router } from '@angular/router';\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\nimport { LoadingController } from '@ionic/angular';\nimport { UserService } from '../services/user.service';\nimport { HttpClient, HttpErrorResponse, HttpHeaders, HttpParams, HttpResponse } from '@angular/common/http';\n\n\n@Component({\nselector: 'app-login',\ntemplateUrl: './login.page.html',\nstyleUrls: ['./login.page.scss'],\n})\nexport class LoginPage implements OnInit {\n\nFB_APP_ID: number = 382437569196107;\n\nconstructor(\n\tprivate fb: Facebook,\n\tprivate nativeStorage: NativeStorage,\n\tpublic loadingController: LoadingController,\n\tprivate router: Router,\n\tprivate user: UserService,\n\tprivate http: HttpClient\n) { }\n\nngOnInit() {\n}\n\ncreateUser(name: any, email: any, birthday: any){\n\tthis.user.createUser(name, email, birthday)\n\t.subscribe(res =>{\n\t\tconsole.log(res);\n\t\tthis.createUserPoints(res);\n\t\tthis.createUserCredit(res);\n\t})\n}\n\ncreateUserPoints(user_id: any){\n\tthis.user.createUserPoints(user_id)\n\t.subscribe(res =>{\n\t\tconsole.log(res);\n\t})\n}\n\ncreateUserCredit(user_id: any){\n\tthis.user.createUserCredit(user_id)\n\t.subscribe(res =>{\n\t\tconsole.log(res);\n\t})\n}\n\nasync doFbLogin(){\n\tconst loading = await this.loadingController.create({\n\t\tmessage: 'Please wait...'\n\t});\n\tthis.presentLoading(loading);\n\tlet permissions = new Array<string>();\n\n\t//the permissions your facebook app needs from the user\n\tpermissions = [\"public_profile\", \"email\", \"user_birthday\"];\n\n\tthis.fb.login(permissions)\n\t.then(response =>{\n\t\tlet userId = response.authResponse.userID;\n\t\tconsole.log(response);\n\t\t//Getting name and gender properties\n\t\tthis.fb.api(\"/me?fields=name,email,birthday\", permissions)\n\t\t.then(user =>{\n\t\t\tuser.picture = \"https://graph.facebook.com/\" + userId + \"/picture?type=large\";\n\t\t\tthis.user.userExist(user.email)\n\t\t\t.subscribe(res => {\n\t\t\t\tif(res == false){\n\t\t\t\t\tthis.createUser(user.name, user.email, user.birthday)\n\t\t\t\t}\n\t\t\t})\n\t\t\t//now we have the users info, let's save it in the NativeStorage\n\t\t\tthis.nativeStorage.setItem('facebook_user',\n\t\t\t{\n\t\t\t\tname: user.name,\n\t\t\t\temail: user.email,\n\t\t\t\tpicture: user.picture,\n\t\t\t\tbirthday: user.birthday\n\t\t\t})\n\t\t\t.then(() =>{\n\t\t\t\t//this.router.navigate([\"/tabs/profile\"]);\n\t\t\t\tthis.router.navigateByUrl('/tabs');\n\n\t\t\t\tloading.dismiss();\n\t\t\t}, error =>{\n\t\t\t\tconsole.log(error);\n\t\t\t\tloading.dismiss();\n\t\t\t})\n\t\t})\n\t}, error =>{\n\t\tconsole.log(error);\n\t\tloading.dismiss();\n\t\t});\n}\n\nasync presentLoading(loading) {\n\treturn await loading.present();\n}\n\ndoFbLogout(){\nthis.fb.logout()\n.then(res =>{\n\t//user logged out so we will remove him from the NativeStorage\n\tthis.nativeStorage.remove('facebook_user');\n\tthis.router.navigate([\"/login\"]);\n}, error =>{\n\t\tconsole.log(error);\n\t});\n}\n}\n","import { Injectable } from '@angular/core';\nimport {HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserService {\n\n  constructor(public http: HttpClient) { }\n\n  getUsers(): Observable<any> {\n    return this.http.get(`http://localhost:3000/api/getUsers`);\n  }\n\n  userExist(email: string): Observable <any> {\n    const params: any = {email: email};\n    return this.http.post(`http://localhost:3000/api/userExist`, params);\n  }\n\n  createUser(name: string, email: string, birthday:any): Observable <any> {\n    const params: any = {name, email, birthday};\n    return this.http.post(`http://localhost:3000/api/createUser`, params);\n  }\n\n  createUserPoints(user_id: number): Observable <any> {\n    const params: any = {user_id};\n    return this.http.post(`http://localhost:3000/api/createUserPoints`, params);\n  }\n\n  createUserCredit(user_id: number): Observable <any> {\n    const params: any = {user_id};\n    return this.http.post(`http://localhost:3000/api/createUserCredit`, params);\n  }\n\n}\n\n"],"sourceRoot":""}