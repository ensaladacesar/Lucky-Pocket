{"version":3,"sources":["webpack:///./src/app/login/login.module.ts","webpack:///./src/app/login/login.page.html","webpack:///./src/app/login/login.page.scss","webpack:///./src/app/login/login.page.ts","webpack:///./src/app/services/user.service.ts"],"names":[],"mappings":"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","file":"login-login-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","module.exports = \"<ion-content padding>\\n  Prueba registro con facebook.\\n  <button ion-button block (click)=\\\"doFbLogin()\\\">Login con facebook</button>\\n</ion-content>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyJ9 */\"","\timport { Component, OnInit } from '@angular/core';\n\timport { Facebook } from '@ionic-native/facebook/ngx';\n\timport { Router } from '@angular/router';\n\timport { NativeStorage } from '@ionic-native/native-storage/ngx';\n\timport { LoadingController } from '@ionic/angular';\n\timport { UserService } from '../services/user.service'\n\timport {HttpClient, HttpErrorResponse, HttpHeaders, HttpParams, HttpResponse} from '@angular/common/http';\n\n\n\t@Component({\n\tselector: 'app-login',\n\ttemplateUrl: './login.page.html',\n\tstyleUrls: ['./login.page.scss'],\n\t})\n\texport class LoginPage implements OnInit {\n\n\tFB_APP_ID: number = 382437569196107;\n\n\tconstructor(\n\t\tprivate fb: Facebook,\n\t\tprivate nativeStorage: NativeStorage,\n\t\tpublic loadingController: LoadingController,\n\t\tprivate router: Router,\n\t\tprivate user: UserService,\n\t\tprivate http: HttpClient\n\t) { }\n\n\tngOnInit() {\n\t}\n\n\tcreateUser(name: any, email: any, birthday: any){\n\t\tthis.user.createUser(name, email, birthday)\n\t\t.subscribe(res =>{\n\t\t\tconsole.log(res);\n\t\t\tthis.createUserPoints(res);\n\t\t\tthis.createUserCredit(res);\n\t\t})\n\t}\n\n\tcreateUserPoints(user_id: any){\n\t\tthis.user.createUserPoints(user_id)\n\t\t.subscribe(res =>{\n\t\t\tconsole.log(res);\n\t\t})\n\t}\n\n\tcreateUserCredit(user_id: any){\n\t\tthis.user.createUserCredit(user_id)\n\t\t.subscribe(res =>{\n\t\t\tconsole.log(res);\n\t\t})\n\t}\n\n\tasync doFbLogin(){\n\tconst loading = await this.loadingController.create({\n\t\tmessage: 'Please wait...'\n\t});\n\tthis.presentLoading(loading);\n\tlet permissions = new Array<string>();\n\n\t//the permissions your facebook app needs from the user\n\tpermissions = [\"public_profile\", \"email\", \"user_birthday\"];\n\n\tthis.fb.login(permissions)\n\t.then(response =>{\n\t\tlet userId = response.authResponse.userID;\n\t\tconsole.log(response);\n\t\t//Getting name and gender properties\n\t\tthis.fb.api(\"/me?fields=name,email,birthday\", permissions)\n\t\t.then(user =>{\n\t\t\tuser.picture = \"https://graph.facebook.com/\" + userId + \"/picture?type=large\";\n\t\t\tthis.user.userExist(user.email)\n\t\t\t.subscribe(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tif(res == false){\n\t\t\t\t\tthis.createUser(user.name, user.email, user.birthday)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t//now we have the users info, let's save it in the NativeStorage\n\t\t\tthis.nativeStorage.setItem('facebook_user',\n\t\t\t{\n\t\t\t\tname: user.name,\n\t\t\t\temail: user.email,\n\t\t\t\tpicture: user.picture,\n\t\t\t\tbirthday: user.birthday\n\t\t\t})\n\t\t\t.then(() =>{\n\t\t\t\t//this.router.navigate([\"/tabs/profile\"]);\n\t\t\t\tthis.router.navigateByUrl('/tabs');\n\n\t\t\t\tloading.dismiss();\n\t\t\t}, error =>{\n\t\t\t\tconsole.log(error);\n\t\t\t\tloading.dismiss();\n\t\t\t})\n\t\t})\n\t}, error =>{\n\t\tconsole.log(error);\n\t\tloading.dismiss();\n\t\t});\n\t}\n\n\tasync presentLoading(loading) {\n\t\treturn await loading.present();\n\t}\n\n\tdoFbLogout(){\n\tthis.fb.logout()\n\t.then(res =>{\n\t\t//user logged out so we will remove him from the NativeStorage\n\t\tthis.nativeStorage.remove('facebook_user');\n\t\tthis.router.navigate([\"/login\"]);\n\t}, error =>{\n\t\t\tconsole.log(error);\n\t\t});\n\t}\n\t}\n","import { Injectable } from '@angular/core';\nimport {HttpClient, HttpErrorResponse, HttpHeaders, HttpParams, HttpResponse} from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserService {\n\n  constructor(public http: HttpClient) { }\n\n  getUsers(): Observable<any> {\n    return this.http.get(`http://localhost:3000/api/getUsers`);\n  }\n\n  userExist(email: string): Observable <any> {\n    const params: any = {email: email};\n    return this.http.post(`http://localhost:3000/api/userExist`, params);\n  }\n\n  createUser(name: string, email: string, birthday:any): Observable <any> {\n    const params: any = {name, email, birthday};\n    return this.http.post(`http://localhost:3000/api/createUser`, params);\n  }\n\n  createUserPoints(user_id: number): Observable <any> {\n    const params: any = {user_id};\n    return this.http.post(`http://localhost:3000/api/createUserPoints`, params);\n  }\n\n  createUserCredit(user_id: number): Observable <any> {\n    const params: any = {user_id};\n    return this.http.post(`http://localhost:3000/api/createUserCredit`, params);\n  }\n\n}\n\n"],"sourceRoot":""}